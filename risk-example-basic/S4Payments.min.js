/*!
 * @shift4/s4payments-web-sdk
 * JavaScript library for creating and communicating with S4Payments.
 * 
 * @version v2.1.3
 * @author Ryan Ploetz
 * @homepage https://github.com/venuenext/S4PaymentsWebSDK#readme
 * @repository git+https://Zephadias@github.com/venuenext/S4PaymentsWebSDK.git
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("S4Payments",[],t):"object"==typeof exports?exports.S4Payments=t():e.S4Payments=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports={events:{START_TOKENIZATION:"START_TOKENIZATION",COLLECT_ALL_VALUES:"COLLECT_ALL_VALUES",FRAME_INITIALIZED:"FRAME_INITIALIZED",TOKENIZATION_COMPLETE:"TOKENIZATION_COMPLETE",VALIDATION_ERROR:"VALIDATION_ERROR",SECURE_FIELD_FOCUS:"SECURE_FIELD_FOCUS",CARD_TYPE_DETERMINATION:"CARD_TYPE_DETERMINATION"}}},function(e,t){var n=!1,r=[],o={},i={},a=!1,s=function(e){var t=e.data;try{t=JSON.parse(e.data)}catch(e){}if(t.eventName){if(i[t.eventName]&&i[t.eventName]!==e.origin)return void(a&&console.log("*** BUS::LISTENER::ORIGINS DID NOT MATCH, NOT PASSING THIS MESSAGE THROUGH TO ANYWHERE ***"));o[t.eventName]&&o[t.eventName].forEach((function(e){e.handler(t.payload)}))}};e.exports={initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n&&"undefined"==typeof window||(n=!0,a=e,window.addEventListener("message",s,!1))},deconstruct:function(){n=!1,window.removeEventListener("message",s,!1)},send:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*",o=arguments.length>3?arguments[3]:void 0;a&&(console.log("*** BUS::SEND ***"),console.log("*** BUS::SEND - eventName: ".concat(e,", targetOrigin: ").concat(n,", frame: ").concat(o)),console.log("*** BUS::SEND::PAYLOAD START ***"),console.log(t),console.log("*** BUS::SEND::PAYLOAD END ***"));var s={payload:t,eventName:e};"*"!==n&&(i[e]=n);var c=JSON.stringify(s);o?o.postMessage(c,n):r.length>0?r.forEach((function(e){e.contentWindow&&(a&&(console.log("*** BUS::SEND::SENDING TO FRAME ***"),console.log(e),console.log("targetOrigin: ".concat(n))),e.contentWindow.postMessage(c,n))})):(a&&console.log("*** BUS::SEND::SENDING TO WINDOW ***"),window.postMessage(c,n),parent&&(a&&console.log("*** BUS::SEND::SENDING TO PARENT ***"),parent.postMessage(c,n)))},receive:function(e,t,n){if(o[e]){for(var r=!1,i=0;i<o[e].length;i++){if(o[e][i].id===n){r=!0;break}}r||o[e].push({handler:t,id:n})}else o[e]=[{handler:t,id:n}]},addFrame:function(e){r.push(e)}}},function(e,t){var n={};e.exports={initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&console.log("********** S4PaymentsWebSDK - pigeon - initialize **********")},send:function(e,t){n[e]&&n[e].forEach((function(e){e(t)}))},addReceiver:function(e,t){n[e]?n[e].push(t):n[e]=[t]}}},function(e,t){e.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t,n=16*(t=new Uint32Array(1),window.crypto.getRandomValues(t),t[0]*Math.pow(2,-32))|0;return("x"===e?n:3&n|8).toString(16)}))}},function(e,t){e.exports={EXTERNAL:{CHANGE_CARD_UI:"CHANGE_CARD_UI",CARD_UPDATE:"CARD_UPDATE",SECURE_FIELD_FOCUS:"SECURE_FIELD_FOCUS",SECURE_FIELD_VALIDATION_ERROR:"SECURE_FIELD_VALIDATION_ERROR",VAULT_RETRIEVED_ALL_CARDS:"VAULT_RETRIEVED_ALL_CARDS",VAULT_CARD_VAULTED:"VAULT_CARD_VAULTED",VAULT_CARD_DELETED:"VAULT_CARD_DELETED",VAULT_CARD_UPDATED:"VAULT_CARD_UPDATED",CARD_TYPE_DETERMINATION:"CARD_TYPE_DETERMINATION",START_WALLET_PROCESS:"START_WALLET_PROCESS",WALLET_PAYMENT:"WALLET_PAYMENT",WALLET_CHANGE:"WALLET_CHANGE",S4PAYMENTS_READY:"S4PAYMENTS_READY",RISK_ASSESSMENT_READY:"RISK_ASSESSMENT_READY",THREE_D_SECURE_ERROR:"THREE_D_SECURE_ERROR",THREE_D_SECURE_READY:"THREE_D_SECURE_READY"},INTERNAL:{RISK_COLLECTION_END:"RISK_COLLECTION_END",RISK_COLLECTION_BEGIN:"RISK_COLLECTION_BEGIN",RISK_COLLECTION_DID_NOT_INITIALIZE:"RISK_COLLECTION_DID_NOT_INITIALIZE",THREE_D_SECURE_COLLECTION_END:"THREE_D_SECURE_COLLECTION_END",THREE_D_SECURE_COLLECTION_BEGIN:"THREE_D_SECURE_COLLECTION_BEGIN"}}},function(e,t){e.exports=function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;for(var o in r.open(e.type,e.url,!0),e.headers)Object.prototype.hasOwnProperty.call(e.headers,o)&&r.setRequestHeader(o,e.headers[o]);if(r.onerror=function(){n({response:r.response,status:r.status})},r.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&t({response:r.response,status:r.status})},e.isFormData){var i,a=[];for(var s in e.data)Object.prototype.hasOwnProperty.call(e.data,s)&&a.push("".concat(encodeURIComponent(s),"=").concat(encodeURIComponent(e.data[s])));i=a.join("&").replace(/%20/g,"+"),r.send(i)}else r.send(e.data)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function(e){return e?JSON.parse(JSON.stringify(e)):null}},function(e,t){e.exports=function(e,t,n,r){var o=document.createElement("iframe");return o.setAttribute("id",e),o.setAttribute("name",t),o.setAttribute("type",r),o.src=n,o.style.border="none",o.style.height="100%",o.style.width="100%",o.style.float="left",o.style.margin="auto",o.style.boxSizing="border-box",o}},function(e,t,n){var r,o=n(23),i=!1;e.exports={initialize:function(e,t,n,a){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];r=e,(i=s)&&console.log("********** S4PaymentsWebSDK - risk - initialize **********"),"kount"===r?o.initialize(n,t.replace(/-/g,""),a,i):console.log("S4PaymentsWebSDK Error: The provider ".concat(r," is currently not supported."))}}},function(e,t,n){var r,o=n(24),i=!1;e.exports={initialize:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=e,(i=a)&&console.log("********** S4PaymentsWebSDK - 3dsecure - initialize **********"),"cardinal"===r?o.initialize(n,i):console.log("S4PaymentsWebSDK Error: The provider ".concat(r," is currently not supported."))},collect:function(e,t,n,a){i&&console.log("********** S4PaymentsWebSDK - 3dsecure - collect **********"),"cardinal"===r?o.collect(e,t,n,a):console.log("S4PaymentsWebSDK Error: The provider ".concat(r," is currently not supported."))}}},function(e,t,n){var r=n(11),o=n(20),i=n(1),a=n(21),s=n(9),c=n(8),l=n(28),u=n(2),d=n(0).events;e.exports={secureFields:r,client:o,bus:i,events:d,sdk:a,threedsecure:s,risk:c,websocket:l,pigeon:u}},function(e,t,n){var r=n(12),o=n(5),i=n(1),a=n(13).isExpDateValid,s=n(0).events,c=n(14),l=r(window.parent),u={},d=!1;e.exports={internalCreate:function(e){e&&(d=!0);var t={},n=0,r=0;i.initialize();var p,f,E=window.name.replace("s4payments-secure-field-",""),v=location.hash.substring(1),h=(p=E,(f=document.createElement("input")).setAttribute("id",p),f.setAttribute("name",p),f.setAttribute("autocorrect","off"),f.setAttribute("autocapitalize","none"),f.setAttribute("spellcheck","false"),f.style.position="absolute",f.style.padding="0",f.style.margin="0",f.style.border="0",f.style.top="0",f.style.left="0",f.style.height="100%",f.style.width="100%",f.style.backgroundColor="transparent !important",f.style.boxSizing="border-box",f.style.fontSize="16px",f.style.outline="none",f.style.paddingLeft="14px",f.style.paddingTop="8px","number"!==p&&"exp"!==p&&"cvv"!==p||(f.setAttribute("type","tel"),f.setAttribute("autocorrect","off"),f.setAttribute("autocapitalize","none"),f.setAttribute("spellcheck","false")),"number"===p&&(f.setAttribute("maxlength",19),f.setAttribute("autocomplete","cc-number"),f.addEventListener("keyup",(function(){var e=f.value.replace(/\s+/g,"");e.length>16&&(e=e.substr(0,16));var t=e.startsWith("34")||e.startsWith("37")?[4,6,5]:[4,4,4,4],n=[],r=0;t.forEach((function(t){var o=e.substr(r,t);o&&n.push(o),r+=t}));var o=n.join(" ");f.value=o;var a={options:c(e)};i.send(s.CARD_TYPE_DETERMINATION,a)}))),"exp"===p&&(f.setAttribute("maxlength",5),f.setAttribute("autocomplete","cc-exp"),f.addEventListener("keyup",(function(){var e=f.value.replace(/\//g,"");e.length>=3?f.value="".concat(e.substr(0,2),"/").concat(e.substr(2,3)):f.value=e}))),"cvv"===p&&(f.setAttribute("maxlength",4),f.setAttribute("autocomplete","cc-csc")),f.addEventListener("focusin",(function(){var e={type:p,focus:"IN"};i.send(s.SECURE_FIELD_FOCUS,e)})),f.addEventListener("focusout",(function(){var e=document.querySelector("input"),t=!0;"exp"===p&&(t=a(e.value.substring(0,2),e.value.substring(2,4)));var n={type:p,focus:"OUT",hasValue:e.value.length>0,valid:t};i.send(s.SECURE_FIELD_FOCUS,n)})),f),y=document.createElement("form");y.setAttribute("action","#"),y.style.position="absolute",y.style.top="0",y.style.left="0",y.style.height="100%",y.style.width="100%",y.style.margin="0",y.style.padding="0",y.style.backgroundColor="transparent",y.style.boxSizing="border-box",y.style.border="none",y.style.overflow="hidden",document.body.appendChild(y).appendChild(h),i.receive(s.START_TOKENIZATION,(function(e){if(d&&(console.log("Secure Fields - BUS RECEIVE START_TOKENIZATION"),console.log(e),console.log("FrameName: ".concat(E))),"number"===E)n=e.total,u.accessBlock=e.accessBlock,u.s4paymentsServer=e.s4paymentsServer,u.secureFieldsServer=e.secureFieldsServer,d&&(console.log("Secure Fields - Set S4Payments Configurations"),console.log(u));else{for(var t,r=document.querySelector("input"),o=0;o<l.length;o++)if("s4payments-secure-field-number"===l[o].name){t=l[o];break}i.send(s.COLLECT_ALL_VALUES,{val:r.value,name:r.name},e.secureFieldsServer,t)}}),"VN_SECURE_FIELDS"),i.receive(s.COLLECT_ALL_VALUES,(function(e){if(d&&(console.log("Frame Name: ".concat(E)),console.log("Secure Field - COLLECT ALL VALUES")),t[e.name]=e.val,++r===n-1){r=0;var a=document.querySelector("input");t[a.name]=a.value;var l=t.number.replace(/\s+/g,"");if(t.cardType=function(e){var t=c(e);if(1===t.length)switch(t[0].type){case"visa":return"VS";case"mastercard":return"MC";case"amex":case"american-express":return"AX";case"discover":return"NS";case"jcb":return"JC";default:return null}return null}(l),t.cardType){var p=function(e){var t={errors:{},isValid:!0};e.number.length<=14&&(t.errors.number="invalid",t.isValid=!1),e.cvv.length<=2&&(t.errors.cvv="invalid",t.isValid=!1),e.exp.length<=3&&(t.errors.exp="invalid",t.isValid=!1);var n=/^[0-9]+$/,r=e.number.replace(/\s+/g,""),o=e.exp.replace(/\//g,"");return r.match(n)||(t.errors.number="invalid",t.isValid=!1),e.cvv.match(n)||(t.errors.cvv="invalid",t.isValid=!1),o.match(n)||(t.errors.exp="invalid",t.isValid=!1),t}(t);if(p.isValid)!function(e){var t={i4go_accessBlock:u.accessBlock,i4go_cardNumber:e.number,i4go_cvv2Code:e.cvv,i4go_cardType:e.cardType,i4go_expirationMonth:e.exp.substring(0,2),i4go_expirationYear:e.exp.substring(3,5)};d&&(console.log("Secure Field - Start Tokenization"),console.log(u)),o({type:"POST",url:"".concat(u.s4paymentsServer,"/index.cfm?fuseaction=api.jsonPostCardEntry"),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},isFormData:!0,data:t}).then((function(t){var n;if(200===t.status){var r=JSON.parse(t.response);d&&(console.log("*** Secure Fields - Response from Shift4 ***"),console.log(r)),"FAILURE"===r.i4go_response?(n={error:"Tokenization Error",key:"DECLINED",errorResponse:{number:"invalid",cvv:"invalid",exp:"invalid"}},i.send(s.VALIDATION_ERROR,n)):(n={cardType:r.i4go_cardtype,expiration:"".concat(r.i4go_expirationmonth,"/").concat(r.i4go_expirationyear),token:r.i4go_utoken,uniqueId:r.i4go_uniqueid,lastFour:r.otn.cardnumber.slice(-4),reference:r.otn.reference,bin:e.number.replace(/ /g,"").slice(0,6)},d&&(console.log("*** Secure Fields - Tokenization Comoplete Payload ***"),console.log(n)),i.send(s.TOKENIZATION_COMPLETE,n))}else n={error:"Tokenization Error",key:"DECLINED",errorResponse:{number:"invalid",cvv:"invalid",exp:"invalid"}},d&&console.log(n),i.send(s.VALIDATION_ERROR,n)})).catch((function(e){var t={error:"Tokenization Error",key:"DECLINED",errorResponse:{number:"invalid",cvv:"invalid",exp:"invalid"}};d&&(console.log(e),console.log(t)),i.send(s.VALIDATION_ERROR,t)}))}(t);else{var f={error:"Card Data not Valid",errorResponse:p.errors};i.send(s.VALIDATION_ERROR,f)}}else{i.send(s.VALIDATION_ERROR,{error:"Card Type Not Supported",errorResponse:{number:"invalid"}})}}}),"VN_SECURE_FIELDS"),i.send(s.FRAME_INITIALIZED,{frameId:v,frameName:E})}}},function(e,t){e.exports=function(e){var t,n,r=[];for(t=0;t<e.frames.length;t++){n=e.frames[t];try{n.location.host===window.location.host&&r.push(n)}catch(e){}}return r}},function(e,t){e.exports={isExpDateValid:function(e,t){var n=new Date,r=n.getMonth()+1,o=n.getFullYear().toString().slice(-2);return!((o=Number(o))>t)&&!(o===t&&r>e)}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=n(15),i=n(16),a=n(18),s=n(19),c=n(6),l={},u={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},d=[u.VISA,u.MASTERCARD,u.AMERICAN_EXPRESS,u.DINERS_CLUB,u.DISCOVER,u.JCB,u.UNIONPAY,u.MAESTRO,u.ELO,u.MIR,u.HIPER,u.HIPERCARD],p=c.clone(d);function f(e){return l[e]||o[e]}function E(e,t){void 0===t&&(t=!1);var n=p.indexOf(e);if(!t&&-1===n)throw new Error('"'+e+'" is not a supported card type.');return n}function v(e){var t=[];if(!a.isValidInputType(e))return t;if(0===e.length)return p.map((function(e){return c.clone(f(e))}));p.forEach((function(n){var r=f(n);i.addMatchingCardsToResults(e,r,t)}));var n=s.findBestMatch(t);return n?[n]:t}v.getTypeInfo=function(e){return c.clone(f(e))},v.removeCard=function(e){var t=E(e);p.splice(t,1)},v.addCard=function(e){var t=E(e.type,!0);l[e.type]=e,-1===t&&p.push(e.type)},v.updateCard=function(e,t){var n=l[e]||o[e];if(!n)throw new Error('"'+e+"\" is not a recognized type. Use `addCard` instead.'");if(t.type&&n.type!==t.type)throw new Error("Cannot overwrite type parameter.");var i=c.clone(n);i=r(r({},i),t),l[i.type]=i},v.changeOrder=function(e,t){var n=E(e);p.splice(n,1),p.splice(t,0,e)},v.resetModifications=function(){p=c.clone(d),l={}},v.types=u,e.exports=v},function(e,t,n){"use strict";e.exports={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,63737423,63743358,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addMatchingCardsToResults=void 0;var r=n(6),o=n(17);t.addMatchingCardsToResults=function(e,t,n){var i,a;for(i=0;i<t.patterns.length;i++){var s=t.patterns[i];if(o.matches(e,s)){var c=r.clone(t);a=Array.isArray(s)?String(s[0]).length:String(s).length,e.length>=a&&(c.matchStrength=a),n.push(c);break}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matches=void 0,t.matches=function(e,t){return Array.isArray(t)?function(e,t,n){var r=String(t).length,o=e.substr(0,r),i=parseInt(o,10);return t=parseInt(String(t).substr(0,o.length),10),n=parseInt(String(n).substr(0,o.length),10),i>=t&&i<=n}(e,t[0],t[1]):function(e,t){return(t=String(t)).substring(0,e.length)===e.substring(0,t.length)}(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidInputType=void 0,t.isValidInputType=function(e){return"string"==typeof e||e instanceof String}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findBestMatch=void 0,t.findBestMatch=function(e){return function(e){var t=e.filter((function(e){return e.matchStrength})).length;return t>0&&t===e.length}(e)?e.reduce((function(e,t){return e?Number(e.matchStrength)<Number(t.matchStrength)?t:e:t})):null}},function(e,t,n){var r,o=n(3),i=n(7),a=n(1),s=n(0).events,c=!1,l={},u=!1;e.exports={initialize:function(e){e.debug&&(u=!0,console.log("S4PaymentsWebSDK --- DEBUG MODE ON ---")),u&&(console.log("********** S4PaymentsWebSDK - client - initialize **********"),console.log(e)),r=e,a.initialize(u),r.accessBlock&&r.s4paymentsServer&&r.fields?(c=!0,r.fields.forEach((function(e){var t=o(),n=document.getElementsByName("s4payments-secure-field-".concat(e));if(!(n&&n.length>0)){u&&console.log("*** S4PaymentsWebSDK - CREATING IFRAME ***");var s=i(t,"s4payments-secure-field-".concat(e),"".concat(r.secureFieldsServer,"#").concat(t),"s4payments");a.addFrame(s);var c=document.getElementById("s4payments__securefield__".concat(e));c?c.appendChild(s):u&&console.log("S4PaymentsWebSDK - Did not find injection site for ".concat(e,"!!!"))}})),a.receive(s.TOKENIZATION_COMPLETE,(function(e){l[s.START_TOKENIZATION]&&l[s.START_TOKENIZATION](e)}),"VN_WEB_CLIENT")):u&&console.log("S4PaymentsWebSDK - Minimum is NOT configured, will not initialize!")},startPaymentTokenization:function(e){u&&console.log("S4PaymentsWebSDK - Start Payment Tokenization"),c?(e&&(l[s.START_TOKENIZATION]=e),a.send(s.START_TOKENIZATION,{total:frames.length-1,accessBlock:r.accessBlock,s4paymentsServer:r.s4paymentsServer,secureFieldsServer:r.secureFieldsServer})):u&&console.log("S4PaymentsWebSDK - Cannot start payment tokenization, minimum has NOT been configured.")}}},function(e,t,n){var r=n(22);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a,s,c,l=n(3),u=n(7),d=n(1),p=n(8),f=n(2),E=n(9),v=n(0),h=n(4),y=v.events,g={},m=!1,S=!1,T=!1,_=!1,I=!1,R="kount",b="cardinal",N="prd";e.exports={initialize:function(e){e.debug&&(m=!0,console.log("S4PaymentsWebSDK --- DEBUG MODE ON ---")),m&&(console.log("********** S4PaymentsWebSDK - sdk - initialize **********"),console.log(e)),(a=e).development&&a.development.mode&&(N=a.development.mode),a.appId&&(c=a.appId),d.initialize(m),f.initialize(m),s=l(),a.enabledServices?(a.enabledServices.forEach((function(e){switch(e){case"risk":S=!0;break;case"3ds":T=!0;break;case"dropin":_=!0;break;case"securefields":I=!0}})),S&&(f.addReceiver(h.INTERNAL.RISK_COLLECTION_BEGIN,(function(e){m&&console.log("RISK_COLLECTION_BEGIN")})),f.addReceiver(h.INTERNAL.RISK_COLLECTION_DID_NOT_INITIALIZE,(function(e){m&&console.log("RISK_COLLECTION_DID_NOT_INITIALIZE"),a.events&&a.events(i({event:h.EXTERNAL.RISK_ASSESSMENT_READY},e))})),f.addReceiver(h.INTERNAL.RISK_COLLECTION_END,(function(e){m&&console.log("RISK_COLLECTION_END : ".concat(e.sessionId)),a.events&&a.events(i({event:h.EXTERNAL.RISK_ASSESSMENT_READY},e))})),a.supportLibrariesEnabled&&a.supportLibrariesEnabled.forEach((function(e){"risk"===e.service&&(R=e.provider)})),a.riskId||console.log("S4PaymentsWebSDK - ERROR - Risk is enabled, but no riskId was provided. Risk will NOT run."),p.initialize(R,s,a.riskId,N,m)),T&&(f.addReceiver(h.INTERNAL.THREE_D_SECURE_COLLECTION_BEGIN,(function(e){m&&console.log("THREE_D_SECURE_COLLECTION_BEGIN : ".concat(e))})),f.addReceiver(h.INTERNAL.THREE_D_SECURE_COLLECTION_END,(function(e){m&&console.log("THREE_D_SECURE_COLLECTION_END : ".concat(e))})),a.supportLibrariesEnabled&&a.supportLibrariesEnabled.forEach((function(e){"3dsecure"===e.service&&(b=e.provider)})),E.initialize(b,s,N,m)),(I||_)&&(a.fields.forEach((function(e){var t=l(),n=document.getElementsByName("s4payments-secure-field-".concat(e));if(!(n&&n.length>0)){m&&console.log("*** S4PaymentsWebSDK - CREATING IFRAME ***");var r=u(t,"s4payments-secure-field-".concat(e),"".concat(a.secureFieldsServer,"#").concat(t),"s4payments");d.addFrame(r);var o=document.getElementById("s4payments__securefield__".concat(e));o?o.appendChild(r):m&&console.log("S4PaymentsWebSDK - Did not find injection site for ".concat(e,"!!!"))}})),d.receive(y.TOKENIZATION_COMPLETE,(function(e){g[y.START_TOKENIZATION]&&g[y.START_TOKENIZATION](e)}),"VN_WEB_CLIENT"))):console.log("*** S4PaymentsWebSDK - enabledServices is required. ***")},startPaymentTokenization:function(e){m&&console.log("S4PaymentsWebSDK - Start Payment Tokenization"),(I||_)&&m&&console.log("S4PaymentsWebSDK - Cannot start payment tokenization, minimum has NOT been configured.")},startCollection:function(e,t,n){if(m&&console.log("S4PaymentsWebSDK - Start Collection"),T){if(!c)return m&&console.log("S4PaymentsWebSDK - ERROR - Configuration was not initialized with an appId, which is required for 3DSecure."),void(g[y.THREE_D_SECURE_ERROR]&&g[y.THREE_D_SECURE_ERROR]({error:"Configuration was not initialized with an appId, which is required for 3DSecure."}));E.collect(c,e,t,n)}}}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r,o=n(2),i=n(4),a=(n(0).events,function(e,t,n){var r=document.createElement("script");r.setAttribute("type","text/javascript");var o="collect/sdk?m=".concat(e,"&s=").concat(t);o="dev"===n?"https://sandbox01.kaxsdc.com/".concat(o):"".concat("https://sandbox01.kaxsdc.com","/").concat(o),r.setAttribute("src",o),document.body.insertBefore(r,document.body.firstElementChild)}),s=function(){var e=document.createElement("span");e.setAttribute("class","kaxsdc"),e.setAttribute("data-event","load"),document.body.insertBefore(e,document.body.firstElementChild)},c=function(){var e,t=!1;setTimeout((function(){t||(clearInterval(e),o.send(i.INTERNAL.RISK_COLLECTION_DID_NOT_INITIALIZE,{sessionId:r}))}),5e3),e=setInterval((function(){if(window.ka){clearInterval(e),t=!0;var n=new ka.ClientSDK;n.setupCallback({"collect-begin":function(e){o.send(i.INTERNAL.RISK_COLLECTION_BEGIN,{})},"collect-end":function(e){o.send(i.INTERNAL.RISK_COLLECTION_END,{sessionId:ka.sessionId})}}),n.autoLoadEvents()}}),250)};e.exports={initialize:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=t,o&&console.log("********** S4PaymentsWebSDK - risk - KNT - initialize **********"),a(e,t,n),s(),c()}}},function(e,t,n){var r=n(25),o=n(27),i=(n(2),n(4),n(5)),a=(n(0).events,function(){var e=o(r.mark((function e(t,n,o,a){var s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s={appId:t,customer:n,cart:o,orderDetails:a},console.log(s),console.log(t),console.log(n),console.log(o),console.log(a),200!==(c=i({type:"POST",url:"https://TBD/payments/authorize",headers:{"Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(s)})).status){e.next=11;break}return e.abrupt("return",JSON.parse(c.response));case 11:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}()),s=function(){var e=o(r.mark((function e(t,n){var o,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{error:"Access Block missing, this is required."});case 2:if(n){e.next=4;break}return e.abrupt("return",{error:"i4m url missing, this is required."});case 4:if(o={i4go_accessBlock:t},200!==(a=i({type:"POST",url:"".concat(n,"/index.cfm?fuseaction=get.get3dsInfo"),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},isFormData:!0,data:o})).status){e.next=14;break}if(1!==(s=JSON.parse(a.response)).success){e.next=12;break}return e.abrupt("return",s.jwt);case 12:e.next=14;break;case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),c=function(){var e=o(r.mark((function e(t,n,o,i){var c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t,n,o,i);case 2:return c=e.sent,console.log(c),e.next=6,s(c.accessBlock,c.i4m_url);case 6:l=e.sent,console.log(l),console.log("TEMP DONE");case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}();e.exports={initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&console.log("********** S4PaymentsWebSDK - 3DSecure - CC - initialize **********")},collect:c}},function(e,t,n){e.exports=n(26)},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return b()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function d(){}function p(){}function f(){}var E={};s(E,o,(function(){return this}));var v=Object.getPrototypeOf,h=v&&v(v(R([])));h&&h!==t&&n.call(h,o)&&(E=h);var y=f.prototype=d.prototype=Object.create(E);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){var r;this._invoke=function(o,i){function a(){return new t((function(r,a){!function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return p.prototype=f,s(y,"constructor",f),s(f,"constructor",p),p.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(m.prototype),s(m.prototype,i,(function(){return this})),e.AsyncIterator=m,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new m(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(e,t){function n(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n(3),n(1),n(0).events;e.exports={initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&console.log("********** S4PaymentsWebSDK - websocket - initialize **********")}}}])}));
//# sourceMappingURL=S4Payments.min.js.map